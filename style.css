/* =========================================
   1. БАЗОВЫЕ НАСТРОЙКИ
   ========================================= */
:root {
  --ui-safe: 220px; /* зона под окно диалога */
  --ui-bg: rgba(0, 0, 0, 0.84);
  --ui-stroke: rgba(255, 255, 255, 0.18);
  --accent: #ffcc00;
  --text: #ffffff;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: #000;
  overflow: hidden;
  font-family:
    system-ui,
    -apple-system,
    Segoe UI,
    Roboto,
    Arial,
    sans-serif;
  user-select: none;
}

#game-container {
  position: relative;
  width: 100vw;
  height: 100vh;
  transition:
    transform 1s ease-out,
    filter 1s ease-out; /* Плавность для зума и блюра */
}

/* Фон */
#background {
  position: fixed; /* FIXED, чтобы не влиял на скролл и другие блоки */
  top: -5vh; /* Запас для параллакса */
  left: -5vw;
  width: 110vw; /* Чуть шире экрана */
  height: 110vh; /* Чуть выше экрана */
  background-size: cover;
  background-position: center;
  z-index: -1; /* Убираем НА САМЫЙ ЗАДНИЙ ПЛАН */
  pointer-events: none; /* Чтобы клики проходили сквозь него, если что */
  transition: transform 0.05s linear;
}

@font-face {
  font-family: "Rubik Wet Paint";
  src: url("assets/fonts/RubikWetPaint-Regular.woff2") format("woff2");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* Курсор для нормального текста */
@keyframes blink {
  50% {
    opacity: 0;
  }
}
.typewriter-cursor::after {
  content: "▋";
  animation: blink 1s step-start infinite;
  color: var(--accent);
  margin-left: 2px;
}

/* --- СТИЛИ ТЕКСТА --- */

/* Нормальный текст */
.text-style-normal {
  font-family: inherit; /* Твой основной шрифт */
  font-size: 18px;
  color: #fff;
  line-height: 1.5;
}

/* ХОРРОР ТЕКСТ (Новый) */
.text-style-horror {
  font-family: "Rubik Wet Paint", "Courier New", monospace !important;
  font-size: 26px;
  color: #ff0000 !important;
  text-shadow: 0 0 5px #500;
  line-height: 1.4;
  letter-spacing: 2px;

  /* Умеренная тряска (было слишком сильно, сделал меньше) */
  display: inline-block; /* Нужно для трансформации */
  animation: subtle-shake 0.2s infinite;
}

@keyframes subtle-shake {
  0% {
    transform: translate(0, 0);
  }
  25% {
    transform: translate(-1px, 1px);
  }
  50% {
    transform: translate(1px, -0.5px);
  }
  75% {
    transform: translate(-0.5px, 1px);
  }
  100% {
    transform: translate(0, 0);
  }
}

/* Красная рамка диалога */
.dialogue-box-horror {
  border: 2px solid #800 !important;
  background: rgba(10, 0, 0, 0.95) !important;
  box-shadow: 0 0 30px rgba(139, 0, 0, 0.4) !important;
}

/* =========================================
   2. ПЕРСОНАЖИ
   ========================================= */
#characters {
  position: absolute;
  inset: 0;
  pointer-events: none;
  display: flex;
  justify-content: center;
  align-items: flex-end;
  gap: 46px;
  padding: 0 40px 40px;
  z-index: 2;
}

.char-container {
  flex: 0 1 340px;
  display: flex;
  flex-direction: column;
  align-items: center;
  opacity: 0;
  transform: translateY(10px);
  transition:
    opacity 260ms ease,
    transform 260ms ease;
}

.char-container.show {
  opacity: 1;
  transform: translateY(0);
}

.char-img {
  height: 78vh;
  max-height: calc(100vh - 40px - var(--ui-safe));
  width: auto;
  object-fit: contain;
  transform-origin: bottom center;
  transition:
    filter 220ms ease,
    transform 220ms ease,
    opacity 220ms ease;
  filter: drop-shadow(0 10px 22px rgba(0, 0, 0, 0.55));
}

.char-container.inactive .char-img {
  opacity: 0.62;
  filter: drop-shadow(0 10px 22px rgba(0, 0, 0, 0.55)) brightness(0.72);
  transform: scale(0.985);
}

.char-container.active .char-img {
  opacity: 1;
  filter: drop-shadow(0 12px 28px rgba(255, 204, 0, 0.18)) brightness(1.05);
  transform: scale(1.02);
}

.char-name {
  display: none;
}

/* =========================================
   3. UI ДИАЛОГОВ
   ========================================= */
#ui-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
  display: none;
  flex-direction: column;
  justify-content: flex-end;
  padding: 18px;
  z-index: 10;
}

#dialogue-box {
  pointer-events: auto;
  background: var(--ui-bg);
  border: 1px solid var(--ui-stroke);
  border-radius: 14px;
  padding: 14px 14px 12px;
  max-width: 860px;
  width: min(860px, 96vw);
  margin: 0 auto 14px;
}

#speaker-name {
  color: var(--accent);
  font-weight: 700;
  margin-bottom: 6px;
  min-height: 1.1em;
}

#dialogue-text {
  color: var(--text);
  font-size: 18px;
  line-height: 1.45;
  min-height: 3.2em;
  white-space: pre-wrap;
}

#hint {
  margin-top: 10px;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.55);
}

/* Quick Menu */
#quick-menu {
  display: flex;
  gap: 15px;
  justify-content: flex-end;
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

#quick-menu button {
  background: transparent;
  border: none;
  color: rgba(255, 255, 255, 0.6);
  font-size: 13px;
  cursor: pointer;
  text-transform: uppercase;
  font-weight: bold;
  letter-spacing: 0.5px;
  padding: 4px 8px;
  transition:
    color 0.2s,
    background 0.2s;
}

#quick-menu button:hover {
  color: #fff;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
}

/* =========================================
   4. ВЫБОРЫ И МЕНЮ
   ========================================= */
#choices-container {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  gap: 10px;
  pointer-events: auto;
  z-index: 12;
}

.choice-btn {
  min-width: min(520px, 90vw);
  padding: 12px 14px;
  text-align: left;
  background: rgba(0, 0, 0, 0.88);
  border: 1px solid rgba(255, 255, 255, 0.22);
  color: #fff;
  border-radius: 12px;
  cursor: pointer;
  transition:
    transform 120ms ease,
    background 120ms ease;
}

.choice-btn:hover {
  background: rgba(255, 255, 255, 0.1);
}
.choice-btn:active {
  transform: translateY(1px);
}

#start-btn {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 50;
  padding: 14px 18px;
  border-radius: 14px;
  border: 1px solid rgba(255, 255, 255, 0.22);
  background: rgba(0, 0, 0, 0.75);
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}

/* =========================================
   5. КАРТА
   ========================================= */
#map-layer {
  position: absolute;
  inset: 0;
  z-index: 5;
  display: none;
}

.map-location {
  position: absolute;
  background: rgba(255, 204, 0, 0.2);
  border: 2px solid rgba(255, 204, 0, 0.6);
  cursor: pointer;
  border-radius: 8px;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  color: #fff;
  font-weight: bold;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
  font-size: 14px;
  text-align: center;
  animation: pulse-border 2s infinite;
}

.map-location:hover {
  background: rgba(255, 204, 0, 0.4);
  border-color: #fff;
  box-shadow: 0 0 15px rgba(255, 204, 0, 0.5);
  transform: scale(1.02);
}

/* === БОЕВОЙ ИНТЕРФЕЙС (FINAL SCREEN MATCH) === */
#battle-layer {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  z-index: 20;
}

/* ВРАГИ */
#enemy-area {
  position: absolute;
  top: 15%;
  width: 100%;
  display: flex;
  justify-content: center;
}
#enemies-container {
  display: flex;
  gap: 40px;
}
.enemy-card {
  width: 130px;
  text-align: center;
  cursor: pointer;
  transition: transform 0.2s;
}
.enemy-card:hover {
  transform: scale(1.05);
}
.enemy-hp-bar {
  width: 100%;
  height: 8px; /* Сделал потолще, было 4px */
  background: #333;
  margin-bottom: 5px;
  border-radius: 4px;
  border: 1px solid #000; /* Добавил рамку, чтобы видеть границы */
  overflow: hidden; /* Важно! */
}

.enemy-hp-fill {
  height: 100%; /* Обязательно! */
  background: #e74c3c; /* Красный цвет */
  transition: width 0.3s;
  width: 100%;
  display: block; /* На всякий случай */
}

/* --- ФИКС ДЛЯ HP ВРАГОВ --- */
.enemy-hp-mini {
  width: 100%;
  height: 6px;
  background: #333;
  border: 1px solid #000;
  margin-bottom: 5px;
  border-radius: 3px;
  overflow: hidden; /* Чтобы заливка не вылезала за рамки */
}

/* Это та же заливка, но убедимся, что она работает внутри mini */
.enemy-hp-mini .enemy-hp-fill {
  height: 100%;
  background: #e74c3c;
  width: 100%;
  display: block;
  transition: width 0.3s ease;
}

/* ЛОГ БОЯ */
#battle-log {
  position: absolute;
  bottom: 220px;
  width: 100%;
  text-align: center;
  color: #fff;
  font-size: 20px;
  font-weight: bold;
  text-shadow: 0 2px 4px #000;
  pointer-events: none;
}

/* ПАНЕЛЬ ГЕРОЯ (HUD) */
/* === ПАНЕЛЬ ГЕРОЯ (HUD) === */
#hero-area {
  position: absolute;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  width: 650px;
  max-width: 95%;

  background: #181818;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 15px 20px; /* Отступы внутри */
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);

  display: flex;
  flex-direction: column;
  gap: 0; /* Убираем дырку между секциями */
  z-index: 10;

  /* Важно: Высота подстраивается под содержимое */
  height: auto;
}

/* Полоски */
#hero-hud {
  display: flex;
  flex-direction: column;
  gap: 6px;
  width: 100%;
  padding-bottom: 15px; /* Отступ до кнопок */
}
.hp-bar-bg {
  width: 100%;
  height: 10px;
  background: #0f0f0f;
  border-radius: 5px;
  position: relative;
  overflow: hidden;
}
#hero-hp-fill {
  height: 100%;
  background: #27ae60;
  transition: width 0.3s;
}
#hero-stamina-fill {
  height: 100%;
  background: #2980b9;
  transition: width 0.3s;
}

/* === КНОПКИ ДЕЙСТВИЙ (ЦЕНТРИРОВАНИЕ) === */
#action-buttons {
  position: relative !important; /* Возвращаем в поток */
  bottom: auto !important;
  left: auto !important;
  transform: none !important;

  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  gap: 20px !important;

  width: 100%;
  padding-top: 15px;
  border-top: 1px solid #333; /* Линия разделитель внутри окна */
  margin: 0;
}

/* УБИРАЕМ ЛИШНИЕ ОТСТУПЫ У ЭЛЕМЕНТОВ */
#action-buttons > * {
  margin: 0 !important;
  flex: 0 0 auto !important; /* Запрещаем растягиваться */
}

/* Ульта */
.ulti-btn {
  background: transparent;
  border: 1px solid #c0392b;
  color: #e74c3c;
  padding: 8px 16px;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  font-size: 14px;
}
.ulti-btn:hover {
  background: #c0392b;
  color: white;
}

/* Основные действия */
.main-actions {
  display: flex;
  gap: 15px;
  border-left: 1px solid #444;
  border-right: 1px solid #444;
  padding: 0 20px;
}

.action-btn {
  background: transparent;
  border: none;
  color: #bbb;
  font-size: 16px;
  cursor: pointer;
  padding: 5px;
  display: flex;
  align-items: center;
  gap: 5px;
}
.action-btn:hover {
  color: #fff;
  transform: scale(1.1);
}

/* Меню справа */
.dropdown-container {
  display: flex;
  gap: 10px;
}

.small-btn {
  background: transparent;
  border: 1px solid #444;
  color: #888;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
}
.small-btn:hover {
  border-color: #777;
  color: #ccc;
}

/* Выпадающие списки */
.dropdown {
  position: relative;
}
.dropdown-content {
  display: none;
  position: absolute;
  bottom: 110%;
  right: 0; /* Открывается от правого края */
  background: #222;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 5px;
  min-width: 120px;
  flex-direction: column;
}
.dropdown-content.open {
  display: flex;
}
.dropdown-content button {
  background: transparent;
  border: none;
  color: #aaa;
  padding: 8px;
  text-align: left;
  cursor: pointer;
}
.dropdown-content button:hover {
  background: #333;
  color: white;
}

/* =========================================
   7. ВСПЛЫВАЮЩИЕ ЭФФЕКТЫ И МОДАЛКИ
   ========================================= */
/* Урон */
.damage-popup {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  color: #ff3333;
  font-weight: bold;
  font-size: 24px;
  text-shadow: 2px 2px 0 #000;
  pointer-events: none;
  z-index: 100;
  animation: floatUp 0.8s forwards;
}
.damage-popup.crit {
  color: #ffcc00;
  font-size: 32px;
}

/* Облачко речи врага */
.enemy-bubble {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: #fff;
  color: #000;
  padding: 8px 12px;
  border-radius: 12px;
  font-size: 14px;
  font-weight: bold;
  white-space: nowrap;
  z-index: 99;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
  opacity: 0;
  transition: opacity 0.3s;
  pointer-events: none;
}
.enemy-bubble::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -6px;
  border-width: 6px;
  border-style: solid;
  border-color: #fff transparent transparent transparent;
}

/* Инвентарь */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  z-index: 2000;
  display: flex;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(5px);
}
.modal-window {
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 12px;
  padding: 20px;
  width: 500px;
  max-width: 90%;
  text-align: center;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
  animation: popIn 0.2s ease-out;
}
.inv-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  justify-content: center;
  margin: 20px 0;
  min-height: 100px;
}
.inv-item-btn {
  background: #333;
  border: 1px solid #555;
  color: #fff;
  padding: 10px;
  border-radius: 8px;
  cursor: pointer;
  width: 140px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  transition: all 0.2s;
}
.inv-item-btn:hover {
  background: #444;
  border-color: #ffcc00;
  transform: translateY(-2px);
}
.inv-item-btn img {
  width: 40px;
  height: 40px;
  object-fit: contain;
}

/* LEVEL UP */
.levelup-popup {
  position: fixed;
  top: 40%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 10000;
  pointer-events: none;
  text-align: center;
  animation: lvl-float 3s ease-out forwards;
}
.lvl-title {
  font-size: 60px;
  font-weight: 900;
  font-style: italic;
  text-transform: uppercase;
  color: #ffd700;
  background: linear-gradient(to bottom, #fff7cc, #ffd700, #b8860b);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  filter: drop-shadow(0 4px 0px rgba(0, 0, 0, 0.5));
  letter-spacing: 2px;
}
.lvl-num {
  font-size: 100px;
  font-weight: 900;
  color: #fff;
  text-shadow:
    0 0 20px #ffd700,
    0 5px 0 #b8860b;
  margin-top: -10px;
  animation: lvl-slam 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.3s
    backwards;
}

/* =========================================
   8. ЭФФЕКТЫ И АНИМАЦИИ
   ========================================= */
/* Кровь и вспышки */
#vignette-layer {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 8;
  background: radial-gradient(
    circle,
    transparent 50%,
    rgba(180, 0, 0, 0.9) 150%
  );
  opacity: 0;
  transition: opacity 0.5s ease;
  mix-blend-mode: multiply;
}

.damage-flash::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(255, 0, 0, 0.4);
  pointer-events: none;
  z-index: 9999;
  animation: flashFade 0.3s forwards;
}

.critical-state::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: 9000;
  pointer-events: none;
  background: radial-gradient(
    circle,
    transparent 60%,
    rgba(160, 0, 0, 0.6) 100%
  );
  animation: heartbeat 1.5s infinite ease-in-out;
}

.critical-hp {
  animation: heartbeat 1.2s infinite;
}

/* Ключевые кадры */
@keyframes shake {
  0%,
  100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-10px);
  }
  50% {
    transform: translateX(10px);
  }
  75% {
    transform: translateX(-10px);
  }
}

@keyframes flashFade {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}
@keyframes heartbeat {
  0% {
    opacity: 0.3;
    transform: scale(1);
  }
  15% {
    opacity: 0.6;
    transform: scale(1.02);
  }
  30% {
    opacity: 0.3;
    transform: scale(1);
  }
  45% {
    opacity: 0.5;
    transform: scale(1.01);
  }
  100% {
    opacity: 0.3;
    transform: scale(1);
  }
}

@keyframes pulse-border {
  0% {
    box-shadow: 0 0 0 0 rgba(255, 204, 0, 0.4);
  }
  70% {
    box-shadow: 0 0 0 6px rgba(255, 204, 0, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(255, 204, 0, 0);
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translate(-50%, 10px);
  }
  to {
    opacity: 1;
    transform: translate(-50%, 0);
  }
}
@keyframes popIn {
  from {
    transform: scale(0.9);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes pulse-ulti {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.05);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes floatUp {
  0% {
    transform: translate(-50%, 0) scale(1);
    opacity: 1;
  }
  50% {
    transform: translate(-50%, -30px) scale(1.2);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -60px) scale(1);
    opacity: 0;
  }
}

@keyframes lvl-float {
  0% {
    opacity: 0;
    transform: translate(-50%, 0) scale(0.8);
  }
  15% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  80% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -150px) scale(1.1);
  }
}

@keyframes lvl-slam {
  0% {
    opacity: 0;
    transform: scale(3);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

/* Адаптив */
@media (max-width: 768px) {
  :root {
    --ui-safe: 210px;
  }
  #characters {
    gap: 14px;
    padding-left: 18px;
    padding-right: 18px;
  }
  .char-container {
    flex-basis: 180px;
  }
  #dialogue-text {
    font-size: 16px;
  }
}

/* Кнопки меню UI */
.ui-btn {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid #777;
  color: white;
  padding: 10px 15px;
  cursor: pointer;
  font-size: 16px;
  border-radius: 5px;
  transition: 0.2s;
}
.ui-btn:hover {
  background: #d4af37;
  color: black;
}

/* Модальное окно (Обновленное) */
.modal {
  position: fixed;
  z-index: 2000; /* Поверх всего */
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.85); /* Затемнение фона */
  display: flex;
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: #222;
  border: 2px solid #d4af37;
  border-radius: 10px;
  width: 600px;
  max-width: 90%;
  max-height: 80vh; /* Максимум 80% высоты экрана */
  display: flex;
  flex-direction: column;
  padding: 20px;
  color: white;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
}

/* ЗАЩИТА ОТ ПЕРЕПОЛНЕНИЯ (OVERFLOW) */
#inv-list {
  flex-grow: 1; /* Занимает всё доступное место */
  overflow-y: auto; /* Включает скролл, если предметов много */
  margin-top: 10px;
  padding-right: 5px; /* Отступ для скроллбара */
  border-top: 1px solid #444;
}

/* Красивый скроллбар (для Webkit браузеров) */
#inv-list::-webkit-scrollbar {
  width: 8px;
}
#inv-list::-webkit-scrollbar-track {
  background: #333;
}
#inv-list::-webkit-scrollbar-thumb {
  background: #666;
  border-radius: 4px;
}

.tab-btn {
  flex: 1;
  padding: 8px;
  background: #333;
  color: #ccc;
  border: 1px solid #555;
  cursor: pointer;
}
.tab-btn:hover {
  background: #444;
  color: white;
}

/* === ТЕМЫ ИНТЕРФЕЙСА (Применяются к .modal-content и #ui-layer) === */

/* 1. Ретро */
body.theme-retro .modal-content,
body.theme-retro #dialogue-box,
body.theme-retro .ui-btn {
  border: 4px double white !important;
  background: black !important;
  font-family: "Courier New", monospace !important;
  border-radius: 0 !important;
  box-shadow: none !important;
}

/* 2. Стекло */
body.theme-glass .modal-content,
body.theme-glass #dialogue-box,
body.theme-glass .ui-btn {
  background: rgba(255, 255, 255, 0.1) !important;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2) !important;
  border-radius: 15px !important;
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
}

/* 3. Золото */
body.theme-gold .modal-content,
body.theme-gold #dialogue-box,
body.theme-gold .ui-btn {
  border: 2px solid #ffd700 !important;
  background: linear-gradient(to bottom, #4b3621, #1a1a1a) !important;
  color: #ffd700 !important;
}
body.theme-gold h2,
body.theme-gold button {
  color: #ffd700 !important;
}

/* 4. Киберпанк */
body.theme-cyber .modal-content,
body.theme-cyber #dialogue-box,
body.theme-cyber .ui-btn {
  border: 2px solid #0ff !important;
  background: #000 !important;
  box-shadow:
    0 0 10px #0ff,
    inset 0 0 20px rgba(0, 255, 255, 0.2) !important;
  color: #0ff !important;
  font-family: sans-serif;
  text-transform: uppercase;
}

/* === ТЕМА: ДНЕВНИК БУДУЩЕГО (Yandere) === */
body.theme-yandere .modal-content,
body.theme-yandere #dialogue-box,
body.theme-yandere .ui-btn {
  background: #000 !important; /* Черная бездна */
  border: 2px solid #ff0000 !important; /* Кровавая рамка */
  color: #ff0000 !important;
  border-radius: 0 !important; /* Острые углы */
  box-shadow:
    0 0 15px rgba(255, 0, 0, 0.6),
    inset 0 0 20px rgba(50, 0, 0, 0.8) !important;
  font-family:
    "Courier New", monospace !important; /* Шрифт печатной машинки/телефона */
  letter-spacing: 1px;
}

/* Имя говорящего */
body.theme-yandere #speaker-name {
  background: #500 !important;
  color: white !important;
  border: 1px solid red !important;
  text-shadow: 2px 2px 0px black;
}

/* Кнопки */
body.theme-yandere .ui-btn:hover,
body.theme-yandere .choice-btn:hover {
  background: #ff0000 !important;
  color: black !important;
  box-shadow: 0 0 20px red !important;
  /* Легкое дрожание при наведении (эффект безумия) */
  animation: shake 0.5s infinite;
}

/* Полоски здоровья в бою */
body.theme-yandere .hp-bar-bg {
  border-color: #500 !important;
  background: #200 !important;
}
body.theme-yandere #hero-hp-fill {
  background: #ff0000 !important; /* Чисто красный */
  box-shadow: 0 0 10px red;
}

/* Анимация дрожания */
@keyframes shake {
  0% {
    transform: translate(1px, 1px) rotate(0deg);
  }
  10% {
    transform: translate(-1px, -2px) rotate(-1deg);
  }
  20% {
    transform: translate(-3px, 0px) rotate(1deg);
  }
  30% {
    transform: translate(3px, 2px) rotate(0deg);
  }
  40% {
    transform: translate(1px, -1px) rotate(1deg);
  }
  50% {
    transform: translate(-1px, 2px) rotate(-1deg);
  }
  60% {
    transform: translate(-3px, 1px) rotate(0deg);
  }
  70% {
    transform: translate(3px, 1px) rotate(-1deg);
  }
  80% {
    transform: translate(-1px, -1px) rotate(1deg);
  }
  90% {
    transform: translate(1px, 2px) rotate(0deg);
  }
  100% {
    transform: translate(1px, -2px) rotate(-1deg);
  }
}

#battle-layer #hero-hp-text {
  color: rgba(255, 255, 255, 0.92) !important;
  font-weight: 700;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.9);
}

/* === СТИЛИ ДЛЯ НЕАКТИВНЫХ КНОПОК === */
button:disabled {
  opacity: 0.4; /* Делаем полупрозрачной */
  filter: grayscale(100%); /* Убираем цвет (делаем серым) */
  cursor: not-allowed; /* Курсор "запрещено" */
  transform: none !important; /* Убираем анимацию нажатия */
  box-shadow: none !important; /* Убираем свечение */
  pointer-events: none; /* Запрещаем клики (на всякий случай) */
}

/* Особый стиль для кнопки УЛЬТЫ, когда она НЕ готова */
#btn-ulti:disabled {
  background: #333 !important; /* Серый фон вместо оранжевого */
  border-color: #555 !important;
}

/* Анимация для ГОТОВОЙ ульты (чтобы игрок видел, что можно жать!) */
#btn-ulti:not(:disabled) {
  animation: ulti-glow 1.5s infinite alternate;
}

@keyframes ulti-glow {
  from {
    box-shadow: 0 0 10px #ffcc00;
  }
  to {
    box-shadow:
      0 0 25px #ff4400,
      0 0 10px #ffcc00 inset;
  }
}

/* === СТИЛИ ДЛЯ МЕНЮ СОХРАНЕНИЙ === */
.save-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr); /* 3 столбца */
  gap: 15px;
  padding: 10px;
}

.save-slot {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid #444;
  border-radius: 8px;
  padding: 15px;
  height: 120px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  transition: all 0.2s;
  position: relative;
}

.save-slot:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: #d4af37;
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
}

.save-slot.empty {
  color: #666;
  border-style: dashed;
}

.save-info-date {
  font-size: 12px;
  color: #aaa;
  margin-top: 5px;
}

.save-info-lvl {
  font-size: 16px;
  font-weight: bold;
  color: #d4af37;
  margin-bottom: 5px;
}

.save-info-chapter {
  font-size: 14px;
  color: #eee;
}

/* Адаптив для телефонов: 2 столбца вместо 3 */
@media (max-width: 768px) {
  .save-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* === ГЛАВНОЕ МЕНЮ (FINAL) === */
.main-menu-layer {
  position: fixed;
  inset: 0;
  background: #000;
  z-index: 10000; /* Подняли выше всех модалок */
  display: none;
  justify-content: center;
  align-items: center;
}

/* Фон меню (отдельный блок для затемнения) */
.menu-bg {
  position: absolute;
  /* Размеры чуть больше экрана, чтобы можно было двигать */
  width: 105vw;
  height: 105vh;
  /* Центрируем этот увеличенный блок */
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%); /* Центрирование */

  background-image: url("assets/bg/main_menu_bg.png"); /* Проверь расширение файла! .png или .jpg? */
  background-size: cover; /* Растянуть на весь блок */
  background-position: center;
  background-repeat: no-repeat;

  z-index: 0; /* Под кнопками */
  pointer-events: none;

  /* Для параллакса мы будем менять translate в JS, 
       но базовое состояние должно быть таким */
}

.menu-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 50px; /* Отступ между лого и кнопками */
  position: relative;
  width: 100%;
  height: 100%;
  justify-content: center;
  position: relative;
  z-index: 10;
}

.menu-bg::after {
  content: "";
  position: absolute;
  inset: 0;
  /* Градиент: Сверху темнее (где лого), снизу светлее */
  background: linear-gradient(
    to bottom,
    rgba(0, 0, 0, 0.6) 0%,
    rgba(0, 0, 0, 0.2) 50%,
    rgba(0, 0, 0, 0.7) 100%
  );
  /* Легкое размытие (опционально, можно убрать если будет тормозить) */
  backdrop-filter: blur(2px);
  z-index: 1;
}

/* --- КНОПКИ --- */
.menu-buttons {
  display: flex;
  flex-direction: column;
  gap: 15px;
  width: 280px;
  z-index: 10001; /* Убедимся, что они кликабельны */
}

/* --- КНОПКИ МЕНЮ (С АНИМАЦИЕЙ) --- */
.menu-btn {
  padding: 14px 0;
  font-size: 18px;
  background: rgba(0, 0, 0, 0.6);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-left: 4px solid #444;
  cursor: pointer;
  text-transform: uppercase;
  font-weight: 600;
  letter-spacing: 2px;
  transition: all 0.2s;

  /* АНИМАЦИЯ ПОЯВЛЕНИЯ */
  opacity: 0; /* Скрыты изначально */
  animation: btn-slide-in 0.8s forwards; /* Запускаем анимацию */
}

/* Задержка для каждой кнопки (через nth-child) */
.menu-buttons .menu-btn:nth-child(1) {
  animation-delay: 0.2s;
}
.menu-buttons .menu-btn:nth-child(2) {
  animation-delay: 0.4s;
}
.menu-buttons .menu-btn:nth-child(3) {
  animation-delay: 0.6s;
}

@keyframes btn-slide-in {
  from {
    opacity: 0;
    transform: translateY(30px); /* Выезжают снизу */
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Ховер эффект оставим прежним */
.menu-btn:hover {
  background: #d4af37;
  color: #000;
  border-left-color: #fff;
  transform: scale(1.05) translateX(10px);
  box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
}

/* --- ГЛИТЧ НАЗВАНИЯ (УПРОЩЕННЫЙ, НО РАБОЧИЙ) --- */
/* --- ВЕРТИКАЛЬНЫЙ ЛОГОТИП (FINAL ULTRA) --- */
.logo-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 2;
  margin-bottom: 40px; /* Отступ до кнопок */
  animation: logo-appear 1.5s ease-out forwards; /* Плавное появление всего блока */
}

/* 1. Верхний текст (PROJECT) */
.logo-top {
  font-family: "Courier New", monospace; /* Технический шрифт */
  font-size: 24px;
  letter-spacing: 14px;
  color: rgba(255, 255, 255, 0.9); /* Ярко-белый */
  font-weight: 600;
  margin-bottom: -15px; /* Наезд на основной текст */
  text-shadow: 0 0 10px rgba(255, 255, 255, 0.5); /* Легкое свечение */
  z-index: 3;
  margin-right: -14px; /* Компенсация letter-spacing */
}

/* 2. Основной текст (Г.О.Ш.А) - СЛОЖНЫЙ ГЛИТЧ */
.logo-main {
  font-size: 130px;
  font-weight: 900;
  color: #fff;
  position: relative;
  letter-spacing: 8px;
  line-height: 1.1;
  z-index: 2;
  text-shadow: 4px 4px 0px rgba(0, 0, 0, 0.5); /* Тень для объема */
}

/* Псевдо-элементы для эффекта расслоения (Глитч) */
.logo-main::before,
.logo-main::after {
  content: attr(data-text);
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: transparent; /* Важно: прозрачный фон */
}

/* Слой 1: Синий сдвиг */
.logo-main::before {
  left: 2px;
  text-shadow: -2px 0 #00ffff; /* Циан */
  animation: glitch-anim-1 2.5s infinite linear alternate-reverse;
  clip-path: inset(0 0 0 0);
}

/* Слой 2: Розовый сдвиг */
.logo-main::after {
  left: -2px;
  text-shadow: 2px 0 #ff00ff; /* Маджента */
  animation: glitch-anim-2 3s infinite linear alternate-reverse;
  clip-path: inset(0 0 0 0);
}

/* 3. Нижний текст (ЛЕГЕНДЫ) */
.logo-bottom {
  font-size: 36px;
  font-weight: 800;
  color: #ffd700; /* Чистое золото */
  letter-spacing: 18px;
  margin-top: -10px;
  margin-right: -18px;
  text-transform: uppercase;
  text-shadow:
    0 0 10px rgba(255, 215, 0, 0.6),
    /* Золотое свечение */ 2px 2px 0px #000; /* Контур */
  position: relative;
  z-index: 3;
}

/* Полоски по бокам от "ЛЕГЕНДЫ" (Декор) */
.logo-bottom::before,
.logo-bottom::after {
  content: "";
  position: absolute;
  top: 50%;
  width: 60px;
  height: 2px;
  background: #ffd700;
  opacity: 0.7;
}

.logo-bottom::before {
  right: 100%;
  margin-right: 20px;
}
.logo-bottom::after {
  left: 100%;
  margin-left: 20px;
}

/* === АНИМАЦИИ === */

@keyframes logo-appear {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Сложный, рваный глитч */
@keyframes glitch-anim-1 {
  0% {
    clip-path: inset(80% 0 0 0);
    transform: translate(-2px, 1px);
  }
  5% {
    clip-path: inset(10% 0 85% 0);
    transform: translate(2px, -1px);
  }
  10% {
    clip-path: inset(40% 0 40% 0);
    transform: translate(-1px, 2px);
  }
  15% {
    clip-path: inset(80% 0 5% 0);
    transform: translate(1px, -2px);
  }
  20% {
    clip-path: inset(10% 0 60% 0);
    transform: translate(0px, 0px);
  }
  100% {
    clip-path: inset(0 0 0 0);
    transform: translate(0, 0);
  }
}

@keyframes glitch-anim-2 {
  0% {
    clip-path: inset(10% 0 60% 0);
    transform: translate(2px, -1px);
  }
  5% {
    clip-path: inset(80% 0 5% 0);
    transform: translate(-2px, 1px);
  }
  10% {
    clip-path: inset(30% 0 20% 0);
    transform: translate(1px, 1px);
  }
  15% {
    clip-path: inset(10% 0 80% 0);
    transform: translate(-1px, -1px);
  }
  20% {
    clip-path: inset(50% 0 30% 0);
    transform: translate(0px, 0px);
  }
  100% {
    clip-path: inset(0 0 0 0);
    transform: translate(0, 0);
  }
}

/* --- АВТОР --- */
.author-text {
  position: absolute;
  bottom: 25px;
  right: 30px;
  color: rgba(255, 255, 255, 0.4);
  font-family: "Courier New", monospace;
  font-size: 14px;
  letter-spacing: 1px;
  text-transform: uppercase;
  border-right: 2px solid #d4af37;
  padding-right: 10px;
}

/* ВАЖНО: Модалки должны быть выше всего, даже меню */
.modal,
.modal-overlay {
  z-index: 20000 !important; /* Было 2000, стало 20000 */
}

/* === ЭКРАНЫ ЗАГРУЗКИ (ИНТРО) === */
.intro-screen {
  position: fixed;
  inset: 0;
  background: #000;
  z-index: 20000; /* Самый верхний уровень, перекрывает даже меню */
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  font-family: "Courier New", monospace; /* Технический стиль */
}

/* Контент дисклеймера */
.disclaimer-content {
  max-width: 600px;
  padding: 40px;
  border: 1px solid #333;
  background: rgba(20, 20, 20, 0.95);
  box-shadow: 0 0 50px rgba(0, 0, 0, 1);
  animation: fade-in 1s ease-out;
}

.disclaimer-content p {
  color: #ddd;
  line-height: 1.6;
  font-size: 18px;
}

/* Кнопка "Принять" */
.intro-btn {
  margin-top: 30px;
  padding: 12px 30px;
  background: transparent;
  border: 1px solid #555;
  color: #fff;
  font-family: inherit;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
  letter-spacing: 2px;
}

.intro-btn:hover {
  background: #fff;
  color: #000;
  border-color: #fff;
  box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
}

/* Логотип студии (Vladber Presents) */
.studio-logo {
  display: flex;
  flex-direction: column;
  align-items: center;
  opacity: 0;
  animation: studio-anim 2.5s ease-in-out forwards; /* Анимация на 2.5 сек */
}

.studio-name {
  font-size: 80px;
  font-weight: 900;
  color: #fff;
  letter-spacing: 10px;
  text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
}

.studio-sub {
  font-size: 20px;
  color: #d4af37; /* Золотой */
  letter-spacing: 15px;
  margin-top: 10px;
  opacity: 0;
  animation: fade-in-up 1s ease-out 0.5s forwards; /* Появляется чуть позже */
}

/* Анимации */
@keyframes studio-anim {
  0% {
    opacity: 0;
    transform: scale(0.9);
  }
  20% {
    opacity: 1;
    transform: scale(1);
  }
  80% {
    opacity: 1;
    transform: scale(1.05);
  }
  100% {
    opacity: 0;
    transform: scale(1.1);
  } /* Исчезает в конце */
}

@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fade-in-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Специфичный стиль для кнопки выхода */
#btn-dialogue-exit {
  font-size: 18px; /* Чуть крупнее для иконки */
  margin-left: auto; /* Прижмет кнопку к правому краю, если в меню есть другие кнопки */
  color: #ff4444 !important; /* Сделаем её красноватой (опасно!) при наведении */
  opacity: 0.7;
}

#btn-dialogue-exit:hover {
  opacity: 1;
  background: rgba(255, 0, 0, 0.2) !important; /* Красная подсветка фона */
}

#map-back-btn {
  position: absolute;
  top: 20px;
  right: 20px;
  width: 50px;
  height: 50px;
  background: rgba(0, 0, 0, 0.7);
  border: 2px solid #fff;
  border-radius: 50%; /* Круглая кнопка */
  color: #fff;
  font-size: 30px;
  cursor: pointer;
  z-index: 100;
  display: none; /* Скрыт по умолчанию */
  align-items: center;
  justify-content: center;
  padding: 0;
  line-height: 1;
}

#map-back-btn:hover {
  background: #c0392b; /* Красный при наведении */
  transform: scale(1.1);
}

/* Контейнер эквалайзера */
.fake-equalizer {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
  background: transparent !important; /* Убираем фон контейнера */
  display: flex;
  justify-content: space-between; /* Растянуть по ширине */
  align-items: flex-end; /* Столбики растут снизу */
  width: 300px; /* Ширина как у кнопок меню */
  height: 40px; /* Высота зоны визуализации */
  margin: 0 auto 20px; /* Центрируем и отступ снизу */
  padding: 0 10px;
  /* background: rgba(0,0,0,0.3); Optional: фон под эквалайзером */
}

/* Сами столбики */
.bar {
  width: 8px; /* Чуть шире */
  background: var(--accent); /* Желтый (#ffcc00) */
  border-radius: 2px 2px 0 0;
  animation: bounce 1s infinite ease-in-out;
  transform-origin: bottom; /* Растут от низа */
  min-height: 3px;
}

.fake-equalizer .bar {
  /* ... старые стили ... */
  box-shadow: none !important; /* Убираем тени */
  border: none !important; /* Убираем границы */
  outline: none !important;
  backface-visibility: hidden; /* Фикс для хрома */
  transform: translateZ(0); /* Включаем GPU ускорение */
}

/* Анимация прыжков */
@keyframes bounce {
  0%,
  100% {
    height: 10%;
    opacity: 0.6;
  }
  50% {
    height: 90%;
    opacity: 1;
    box-shadow: 0 0 10px var(--accent);
  }
}

/* Подстройка под бит ~128 BPM (0.46s на бит) */
.bar:nth-child(1) {
  animation-duration: 0.46s;
  animation-delay: 0.1s;
}
.bar:nth-child(2) {
  animation-duration: 0.92s;
  animation-delay: 0.2s;
} /* 2 бита */
.bar:nth-child(3) {
  animation-duration: 0.69s;
  animation-delay: 0s;
}
.bar:nth-child(4) {
  animation-duration: 0.46s;
  animation-delay: 0.3s;
}
.bar:nth-child(5) {
  animation-duration: 1.38s;
  animation-delay: 0.1s;
} /* 3 бита */
.bar:nth-child(6) {
  animation-duration: 0.69s;
  animation-delay: 0.4s;
}
.bar:nth-child(7) {
  animation-duration: 0.92s;
  animation-delay: 0.2s;
}
.bar:nth-child(8) {
  animation-duration: 0.46s;
  animation-delay: 0.1s;
}

/* Сделаем анимацию более резкой (как удар барабана) */
@keyframes bounce {
  0% {
    height: 10%;
  }
  20% {
    height: 90%;
  } /* Резкий скачок вверх */
  100% {
    height: 10%;
  } /* Плавный спуск */
}

/* Общий контейнер */
.equalizer-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 15px;
  position: relative;
}

/* Сами бары (убедимся, что они стоят на линии) */
.fake-equalizer {
  margin-bottom: -2px; /* Чуть "утапливаем" в подставку */
  z-index: 2;
}

/* Подставка */
.equalizer-base {
  width: 320px; /* Шире эквалайзера */
  height: 4px;
  background: var(--accent); /* Желтый цвет */
  box-shadow:
    0 0 10px var(--accent),
    0 0 20px rgba(255, 204, 0, 0.4);
  border-radius: 2px;
  position: relative;
  display: flex;
  justify-content: center;
}

/* Текст "G.O.S.H.A" под линией */
.base-text {
  position: absolute;
  top: 8px; /* Чуть ниже линии */
  font-size: 10px;
  letter-spacing: 6px;
  color: rgba(255, 255, 255, 0.5);
  font-weight: 900;
  text-transform: uppercase;
}

/* Декоративные ножки или затухание по краям */
.base-line {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(
    90deg,
    transparent 0%,
    var(--accent) 50%,
    transparent 100%
  );
  opacity: 0.8;
}

/* --- СТИЛИ ТЕКСТА --- */
/* Фон диалога при хорроре (Опционально: делает окно темнее/краснее) */
.dialogue-box-horror {
  border-color: #800 !important;
  background: rgba(20, 0, 0, 0.95) !important;
  box-shadow: 0 0 20px rgba(255, 0, 0, 0.3) !important;
}

@keyframes horror-shake {
  0% {
    transform: translate(0, 0) rotate(-1deg);
  }
  25% {
    transform: translate(-1px, 1px) rotate(0deg);
  }
  50% {
    transform: translate(1px, -1px) rotate(1deg);
  }
  75% {
    transform: translate(-1px, -1px) rotate(-1deg);
  }
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}

/* --- НОВЫЕ АНИМАЦИИ ДЛЯ ПЕРСОНАЖЕЙ И КАМЕРЫ --- */

/* 1. ПЕРСОНАЖИ */

/* Подпрыгивание (Радость, удивление) */
@keyframes char-jump {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-30px);
  }
}
.anim-jump {
  animation: char-jump 0.4s ease-out;
}

/* Тряска (Злость, страх, удар) */
@keyframes char-shake {
  0%,
  100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-10px);
  }
  75% {
    transform: translateX(10px);
  }
}
.anim-shake {
  animation: char-shake 0.3s ease-in-out;
}

/* Наклон (Подозрение, вопрос) */
@keyframes char-tilt {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(15deg);
  }
}
/* Здесь мы оставляем наклон, поэтому forwards */
.anim-tilt {
  animation: char-tilt 0.3s forwards;
}

/* 2. КАМЕРА (Эффекты на весь экран) */

/* Землетрясение / Сильный удар */
@keyframes cam-quake {
  0% {
    transform: translate(0, 0);
  }
  20% {
    transform: translate(-10px, 10px);
  }
  40% {
    transform: translate(10px, -10px);
  }
  60% {
    transform: translate(-10px, -10px);
  }
  80% {
    transform: translate(10px, 10px);
  }
  100% {
    transform: translate(0, 0);
  }
}
.cam-quake {
  animation: cam-quake 0.5s linear;
}

/* Зум (Драматичный момент) */
@keyframes cam-zoom {
  0% {
    transform: scale(1);
  }
  100% {
    transform: scale(1.2);
  }
}
.cam-zoom {
  transform: scale(1.2) !important;
}

/* Вспышка (Молния, озарение) */
@keyframes cam-flash {
  0% {
    filter: brightness(1);
  }
  50% {
    filter: brightness(3);
  } /* Очень ярко */
  100% {
    filter: brightness(1);
  }
}
.cam-flash {
  animation: cam-flash 0.5s ease-out;
}

/* Блур (Головокружение, сон) */
.cam-blur {
  filter: blur(5px);
  transition: filter 1s;
}
.cam-normal {
  filter: blur(0px);
  transition: filter 1s;
}

/* =========================================
   9. АНИМАЦИИ ПЕРЕХОДОВ (НОВОЕ)
   ========================================= */

/* --- 1. Эффект начала игры (Растворение меню) --- */
.menu-fade-out-anim {
  animation: menu-dive 1.5s forwards ease-in;
  pointer-events: none; /* Чтобы нельзя было кликнуть пока исчезает */
}

@keyframes menu-dive {
  0% {
    opacity: 1;
    transform: scale(1);
    filter: blur(0px);
  }
  100% {
    opacity: 0;
    transform: scale(1.2); /* Легкий наезд камеры */
    filter: blur(5px); /* Размытие в конце */
  }
}

/* --- 2. Эффект выхода (CRT TV Turn Off) --- */
.crt-off-layer {
  position: fixed;
  inset: 0;
  background: #000; /* Цвет "выключенного" экрана */
  z-index: 99999; /* Поверх всего вообще */
  opacity: 0;
  pointer-events: none;
  display: none; /* Скрыт по умолчанию */
}

/* Класс, который запускает анимацию */
.crt-off-active {
  display: block !important;
  opacity: 1;
  animation: tv-turn-off 0.7s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

/* Сама анимация схлопывания */
@keyframes tv-turn-off {
  0% {
    transform: scale(1, 1);
    background: #fff; /* Яркая вспышка перед выключением */
    opacity: 0.8;
  }
  40% {
    transform: scale(1, 0.005); /* Сплющиваем по вертикали в полоску */
    background: #fff;
    opacity: 1;
  }
  70% {
    transform: scale(0.01, 0.005); /* Сплющиваем полоску в точку */
    background: #fff;
  }
  100% {
    transform: scale(0, 0); /* Исчезновение */
    background: #000;
    opacity: 1;
  }
}
/* Стиль для мыслей */
#dialogue-text.thought {
  color: #aaa;
  font-style: italic;
  font-family: "Courier New", monospace; /* Опционально, для атмосферы */
}

/* --- style.css --- */

/* Контейнер для QTE (на весь экран, поверх всего) */
#qte-layer {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none; /* Чтобы клики проходили сквозь */
  z-index: 9000;
  display: none;
}

/* Сама буква */
.qte-key {
  position: absolute;
  width: 80px;
  height: 80px;
  border: 4px solid #fff;
  border-radius: 50%;
  color: #fff;
  font-size: 40px;
  font-weight: bold;
  display: flex;
  justify-content: center;
  align-items: center;
  background: rgba(0, 0, 0, 0.5);
  box-shadow:
    0 0 20px #fff,
    inset 0 0 10px #fff;
  animation: qte-pulse 0.5s infinite alternate;
}

/* Таймер (кольцо вокруг - опционально, пока просто пульсация) */
@keyframes qte-pulse {
  from {
    transform: scale(1);
    border-color: #fff;
  }
  to {
    transform: scale(1.1);
    border-color: #ff0000;
  }
}

/* Экран смерти (Красная вспышка) */
#damage-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: red;
  opacity: 0;
  pointer-events: none;
  z-index: 9999;
  transition: opacity 0.5s;
}

.hotspot {
  position: absolute;
  z-index: 10;
  /* background: rgba(255, 0, 0, 0.2);  <-- Включи для отладки, чтобы видеть зоны */
}
.hotspot:hover {
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); /* Подсветка при наведении */
}

.inspect-content {
  background: #111;
  border: 2px solid #d4af37;
  border-radius: 12px;
  padding: 18px;
  width: min(560px, 92vw);
  color: #eee;
}
#inspect-title {
  font-size: 22px;
  margin-bottom: 10px;
  color: #ffd700;
}
#inspect-desc {
  font-size: 16px;
  line-height: 1.45;
  color: #ccc;
  margin-bottom: 14px;
}
.inspect-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

/* Контейнер для тостов */
#toast-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.toast {
  background: rgba(0, 0, 0, 0.9);
  color: #fff;
  padding: 12px 20px;
  border-radius: 4px;
  min-width: 250px;
  animation:
    slideInRight 0.3s ease-out,
    fadeOut 0.5s 2.5s forwards;
  font-family: "Play", sans-serif;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
}

/* Цвета для разных уведомлений */
.toast-info {
  border-left: 5px solid #d4af37;
} /* Золотой */
.toast-success {
  border-left: 5px solid #44ff44;
  box-shadow: 0 0 10px rgba(68, 255, 68, 0.4);
} /* Зеленый */
.toast-error {
  border-left: 5px solid #ff4444;
  box-shadow: 0 0 10px rgba(255, 68, 68, 0.4);
} /* Красный */

/* Окно подтверждения */
.confirm-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(4px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
}

.confirm-box {
  background: #111;
  border: 2px solid #d4af37;
  padding: 30px;
  text-align: center;
  border-radius: 8px;
  box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
  max-width: 400px;
}

.confirm-buttons {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 20px;
}

@keyframes slideInRight {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes fadeOut {
  to {
    opacity: 0;
    transform: translateY(-10px);
  }
}

/* Делаем текст в окне подтверждения белым/светлым */
#confirm-message {
  color: #fff !important;
  font-size: 1.2rem;
  margin-bottom: 20px;
  line-height: 1.4;
}

/* Поднимаем уведомления выше всех слоев (z-index) */
#toast-container {
  z-index: 99999 !important; /* Больше, чем у модалок */
}

/* Поднимаем окно подтверждения выше меню сохранений */
.confirm-overlay {
  z-index: 99998 !important;
}

#history-log-container {
  max-height: 400px;
  overflow-y: auto;
  padding: 15px;
  background: rgba(0, 0, 0, 0.8);
  border: 1px solid #d4af37;
  text-align: left;
  color: #eee;
}

.history-item {
  margin-bottom: 12px;
  border-bottom: 1px solid #333;
  padding-bottom: 5px;
}

.history-name {
  color: #d4af37;
  font-weight: bold;
  margin-right: 10px;
}

.history-text {
  color: #fff;
}
